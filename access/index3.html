<!DOCTYPE html>
<html lang="en">
    <head>
        <title>FisaAccess3</title>

        <meta charset="utf-8"> 

        <link rel="stylesheet" href="style.css">

    </head>
    <body>
        </br>
        <div class="box">
        <PageTitle style="text-align:center">
            <h1>
                    <u>F I Ş A Nr. 3<br></u>
                    Crearea relaţiilor
            </h1>
        </PageTitle><br>

        <p>
            Să presupunem că avem o tabelă unde ţinem datele despre copii angajaţilor. Din
            ribbon-ul <bi>Create</bi> creăm un nou tabel <bi>(Table)</bi>.
        </p>
        <p>
            Mergem în modul de vizualizare <bi>Design View</bi>,<img src="img/1.4.png"> pentru a realiza
            structura tabelului. În acest moment introducem numele noului tabel: <b>COPII</b>. Apăsăm <b>OK</b>
        </p>

        <table>
            <tr>
                <td><img src="img/3.1.png"></td>
                <td>
                    <p>
                        Structura tabelului va fi următoarea: 
                        <ul>
                            <li><b>ID_COPIL</b>, de tip <bi>Autonumber</bi>; </li>
                            <li><b>Prenume</b>, de tip <bi>Text</bi>;</li>
                            <li><b>DataN</b>, de tip <bi>Date/Time</bi>.</li>
                        </ul>
                    </p>
                </td>
            </tr>
        </table>

        <p>Salvăm modificările şi mergem în modul DatasheetView.<img src="img/1.2.png"> Introduceţi o serie de date ca în imaginea de mai jos.</p>

        <table>
            <tr>
                <td><img src="img/3.2.png"></td>
                <td>
                    <p>
                        Acum avem două tabele: <br>
                        <b>ANGAJAŢI</b> şi <b>COPII</b>. Aşa cum în viaţa reală există o legătură între angajaţi şi
                        copii lor, aşa şi în <bi>Access</bi> trebuie să avem acea relaţionare între cele două tabele, intre cele două entităţi separate.
                    </p>
                </td>
            </tr>
            <tr>
                <td  colspan="2">
                    <p>Observăm ca deocamdată cele două tabele sunt complet independente şi nu există nimic comun acestora.</p>
                </td>
            </tr>
        </table>

        <p>În tabela COPII mergeţi in modul <bi>Design View</bi>. <img src="img/1.4.png"></p>
        <p>Adăugăm o nouă coloană imediat după coloana <b>ID_COPIL</b>: facem click dreapta pe linia <bi>Prenume</bi> şi alegem <bi>Insert rows</bi>.</p>
        <p>Introducem numele ID_Parinte şi ca tip alegem acelaşi ca şi PrimaryKey-ul din ANGAJATI – ID_CLIENT (<b>Number</b>).</p>

        <img src="img/3.3.png">

        <p>Salvăm şi revenim în modul <bi>DatasheetView</bi>. <img src="img/1.2.png"></p>

        <table>
            <tr>
                <td><img src="img/3.4.png"></td>
                <td>
                    Pentru a stabili exact relaţia, adică pentru a specifica faptul că datele din coloana ID_CLIENT din ANGAJATI este replicată în
                    ID_Parinte din COPII, mergem în <bi>DatabaseTools>Relationships</bi>. Selectăm ambele tabele şi apăsăm <b>Add</b>, apoi <b>Close</b>. 
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <p>
                        Cele două tabele nu sunt încă relaţionate. Tragem (Drag&Drop) coloana ID_CLIENT din ANGAJATI peste coloana ID_Parinte din COPII. 
                        În fereastra deschisă bifăm checkbox-ul<b>EnforceReferentialIntegrity</b>. Apăsăm <b>Create</b>.
                    </p>
                </td>
            </tr>
        </table>

        <img src="img/3.5.png">

        <p style="text-indent: 0;"><tot>Atenţie !</tot> Este obligatoriu să închidem tabelele înainte de a face această operaţie de relaţionare.</p>

        <p>Observăm că apare relaţia ‘1 la n’ (<b>‘1 la ∞’</b>).</p>

        <img src="img/3.6.png">

        <p>
            Deschidem tabela <b>COPII</b>. Coloana <bi>ID_Parinte</bi> stochează ID-ul corespunzător părintelui. De exemplu, dacă în prima linie scriem <b>1</b>, 
            stabilim că părintele lui Gigel este Ionescu, care are ID_CLIENT 1 în tabela <b>ANGAJATI</b>.
        </p>
        <p>
            Tot în coloana ID_Parinte introducem 1 şi pentru linia 3 (Mirela). Asta înseamnă
            că părintele Ionescu are doi copii: Mirela şi Gigel. Introducem 3 în coloana ID_Parinte din  rândul 2 (Vasilescu are un singur copil, Anuta)
        </p>

        <img src="img/3.7.png">
        </div>
    </body>
</html>